import{a as D}from"./chunk-J3BUK4MO.js";import{a as k}from"./chunk-F245QUT2.js";import{a as U}from"./chunk-TFEDABXG.js";import{a as F,c as z,f as I,p as T}from"./chunk-LNBIFSMN.js";import{a as j}from"./chunk-7ASKJ65C.js";import{a as w}from"./chunk-YESQC6II.js";import{m as M,n as A,p as x}from"./chunk-UHNCRVEK.js";import{$ as h,Bb as s,Db as b,Eb as g,Jb as _,Ob as C,Qb as y,Ua as c,Va as u,Ya as p,a as v,b as E,cb as l,hb as f,kb as i,lb as r,ub as m,vb as S}from"./chunk-GYUG5PKY.js";function q(o,N){if(o&1&&(i(0,"div",9)(1,"div",10)(2,"div",11)(3,"h3",12),s(4,"Fecha de alta"),r()(),i(5,"p",13),s(6),C(7,"date"),r()(),i(8,"div",10)(9,"div",11)(10,"h3",12),s(11,"Usuario creador"),r()(),i(12,"p",14),s(13),r()()()),o&2){let a=S();c(6),b(" ",y(7,3,a.encuestasService.abmEncuesta.encuestaSeleccionada.createdAt,"dd/MM/yyyy")," "),c(7),g(" ",a.encuestasService.abmEncuesta.encuestaSeleccionada.creatorUser.apellido.toLowerCase()," ",a.encuestasService.abmEncuesta.encuestaSeleccionada.creatorUser.nombre.toLowerCase()," ")}}var Y=(()=>{class o{constructor(a,n,e,t){this.authService=a,this.alertService=n,this.encuestasService=e,this.toastr=t,this.insertEvent=new p,this.updateEvent=new p}ngOnInit(){}nuevaEncuesta(){let a=this.verificacionFormulario();if(a.trim()!==""){this.alertService.info(a);return}this.alertService.question({msg:"Creando nueva encuesta",buttonText:"Aceptar"}).then(({isConfirmed:n})=>{if(n){this.alertService.loading();let e=E(v({},this.encuestasService.abmEncuesta.form),{creatorUserId:this.authService.usuario.userId});this.encuestasService.nuevaEncuesta(e).subscribe({next:({encuesta:t})=>{this.insertEvent.emit(t),this.reinicioFormulario(),this.encuestasService.abmEncuesta.show=!1,this.toastr.success("Creada correctamente","Encuesta"),this.alertService.close()},error:({error:t})=>this.alertService.errorApi(t.message)})}})}actualizarEncuesta(){let a=this.verificacionFormulario();if(a.trim()!==""){this.alertService.info(a);return}this.alertService.question({msg:"Actualizando encuesta",buttonText:"Aceptar"}).then(({isConfirmed:n})=>{if(n){this.alertService.loading();let e=this.encuestasService.abmEncuesta.form;this.encuestasService.actualizarEncuesta(this.encuestasService.abmEncuesta.encuestaSeleccionada.id,e).subscribe({next:({encuesta:t})=>{this.updateEvent.emit(t),this.reinicioFormulario(),this.encuestasService.abmEncuesta.show=!1,this.toastr.success("Actualizada correctamente","Encuesta"),this.alertService.close()},error:({error:t})=>this.alertService.errorApi(t.message)})}})}verificacionFormulario(){let{titulo:a}=this.encuestasService.abmEncuesta.form;return a.trim()===""?"El titulo es requerido":""}submit(){this.encuestasService.abmEncuesta.estado=="crear"?this.nuevaEncuesta():this.actualizarEncuesta()}reinicioFormulario(){this.encuestasService.abmEncuesta.form={titulo:"",descripcion:""}}static{this.\u0275fac=function(n){return new(n||o)(u(w),u(j),u(D),u(k))}}static{this.\u0275cmp=h({type:o,selectors:[["app-abm-encuestas"]],outputs:{insertEvent:"insertEvent",updateEvent:"updateEvent"},standalone:!0,features:[_],decls:16,vars:10,consts:[[3,"showModal","titulo","urlIcono","estadoFormulario","textoCrear","textoActualizar","showFooter","closeModal","crear","actualizar"],[1,"bg-white","rounded-lg","shadow-xl"],[1,"p-6","max-h-96","overflow-y-auto"],[1,"space-y-4"],[1,"label-generico","mb-1"],[1,"text-red-500"],["type","text","placeholder","Ej. Encuesta de Satisfacci\xF3n",1,"input-generico","mt-1",3,"ngModel","keyup.enter","ngModelChange"],["type","text","placeholder","Ej. Esta encuesta busca evaluar...",1,"input-generico","mt-1",3,"ngModel","keyup.enter","ngModelChange"],["class","grid md:grid-cols-2 gap-4 mt-4",4,"ngIf"],[1,"grid","md:grid-cols-2","gap-4","mt-4"],[1,"bg-gray-50","p-4","rounded-lg","border","border-gray-300"],[1,"flex","items-center"],[1,"text-sm","font-semibold","text-gray-700"],[1,"text-sm","text-gray-600","mt-1"],[1,"text-sm","text-gray-600","mt-1","capitalize"]],template:function(n,e){n&1&&(i(0,"app-modal",0),m("closeModal",function(){return e.encuestasService.abmEncuesta.show=!1})("crear",function(){return e.nuevaEncuesta()})("actualizar",function(){return e.actualizarEncuesta()}),i(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"label",4),s(6," T\xEDtulo "),i(7,"span",5),s(8,"*"),r()(),i(9,"input",6),m("keyup.enter",function(){return e.submit()})("ngModelChange",function(d){return e.encuestasService.abmEncuesta.form.titulo=d}),r()(),i(10,"div")(11,"div")(12,"label",4),s(13," Descripci\xF3n "),r(),i(14,"input",7),m("keyup.enter",function(){return e.submit()})("ngModelChange",function(d){return e.encuestasService.abmEncuesta.form.descripcion=d}),r()()(),f(15,q,14,6,"div",8),r()()()()),n&2&&(l("showModal",e.encuestasService.abmEncuesta.show)("titulo",e.encuestasService.abmEncuesta.estado=="crear"?"Creando encuesta":"Editando encuesta")("urlIcono","assets/svg/encuestas.svg")("estadoFormulario",e.encuestasService.abmEncuesta.estado)("textoCrear","Crear encuesta")("textoActualizar","Actualizar encuesta")("showFooter",!0),c(9),l("ngModel",e.encuestasService.abmEncuesta.form.titulo),c(5),l("ngModel",e.encuestasService.abmEncuesta.form.descripcion),c(1),l("ngIf",e.encuestasService.abmEncuesta.encuestaSeleccionada&&e.encuestasService.abmEncuesta.estado==="editar"))},dependencies:[x,M,A,T,F,z,I,U],encapsulation:2})}}return o})();export{Y as a};
