import{g}from"./chunk-LRQMHJK3.js";import{v as f,x as d}from"./chunk-PL2ZQQHO.js";import{F as u,T as p,X as m,aa as c,p as l,t as i}from"./chunk-DRQLPHCS.js";var n=class{constructor(k,e,t,o,s){this.userId=k,this.usuario=e,this.nombre=t,this.apellido=o,this.role=s}};var a=d.base_url,E=(()=>{class r{constructor(e,t){this.http=e,this.router=t,this.isAdmin=!1}login(e){return this.http.post(`${a}/auth/login`,e).pipe(p(({token:t})=>{let o="bearer "+t;localStorage.setItem("token",o)}))}logout(){localStorage.removeItem("token"),this.router.navigateByUrl("login")}validarToken(){let e=localStorage.getItem("token");return this.http.get(`${a}/auth/profile`,{headers:{Authorization:e}}).pipe(i(t=>{let{userId:o,usuario:s,apellido:I,nombre:b,role:h}=t.usuario;return this.usuario=new n(o,s,b,I,h),this.isAdmin=h==="ADMIN_ROLE",localStorage.setItem("token",t.token),!0}),u(t=>l(!1)))}validarAdmin(){let e=localStorage.getItem("token");return this.http.get(`${a}/auth/profile`,{headers:{Authorization:e}}).pipe(i(t=>t.usuario.role==="ADMIN_ROLE"))}proteccionLogin(){let e=localStorage.getItem("token");return this.http.get(`${a}/auth`,{headers:{"x-token":e}}).pipe(i(()=>!1),u(t=>l(!0)))}static{this.\u0275fac=function(t){return new(t||r)(c(f),c(g))}}static{this.\u0275prov=m({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{E as a};
