import{a as W}from"./chunk-NST4HIMD.js";import{a as K}from"./chunk-GN3ET3J5.js";import{a as ee}from"./chunk-HDOPZBNZ.js";import{a as X,b as Y,c as Z}from"./chunk-EGVL2UNI.js";import{a as Q}from"./chunk-WCA5KJBW.js";import{a as J}from"./chunk-TIL2E3OS.js";import{a as H}from"./chunk-VUVQYZVZ.js";import"./chunk-5QPYTDH3.js";import{a as q}from"./chunk-HZWOLOZV.js";import{a as G}from"./chunk-JTVQZKZI.js";import{h as $,k as z}from"./chunk-LRQMHJK3.js";import{k as B,l as O,m as R,p as N}from"./chunk-PL2ZQQHO.js";import{$b as T,Ab as c,Jb as I,Kb as o,Lb as b,Mb as M,Nb as P,Tb as D,Ua as s,Va as y,Vb as _,Wb as k,Yb as C,_b as U,ga as L,ib as x,ja as A,kb as l,nb as F,ob as j,pb as V,qa as g,qb as e,ra as v,rb as r,sa as w,sb as m,ta as E,vb as S,zb as h}from"./chunk-DRQLPHCS.js";var te=(()=>{class i{transform(t,a,n){let u,p;return n==="true"?u=!0:n==="false"?u=!1:u=null,u!==null?p=t.filter(f=>f.activo==u):u===null&&(p=t),a=a.toLocaleLowerCase(),a.length!==0?p.filter(f=>f.apellido.toLocaleLowerCase().includes(a)||f.nombre.toLocaleLowerCase().includes(a)||f.usuario.toLocaleLowerCase().includes(a)):p}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275pipe=A({name:"filtroUsuarios",type:i,pure:!0,standalone:!0})}}return i})();var se=(i,d)=>d.id,ie=(i,d)=>({itemsPerPage:i,currentPage:d}),re=i=>({"bg-orange-50":i}),ne=i=>["/dashboard/usuarios/editar",i],oe=i=>["/dashboard/usuarios/password",i];function le(i,d){i&1&&(w(),e(0,"svg",50),m(1,"polyline",51),r())}function de(i,d){i&1&&(w(),e(0,"svg",50),m(1,"polyline",52),r())}function ue(i,d){i&1&&(w(),e(0,"svg",50),m(1,"line",53),r())}function me(i,d){i&1&&(e(0,"div",65),o(1," E "),r())}function ce(i,d){i&1&&(e(0,"div",66),o(1," A "),r())}function pe(i,d){i&1&&(e(0,"div",67),o(1," En "),r())}function fe(i,d){if(i&1){let t=S();e(0,"app-pastilla-estado",68),h("click",function(){g(t);let n=c().$implicit,u=c();return v(u.actualizarEstado(n))}),r()}if(i&2){let t=c().$implicit;l("activo",t.activo)}}function xe(i,d){if(i&1&&(e(0,"button",69),m(1,"img",70),e(2,"span",41),o(3,"Editar"),r()()),i&2){let t=c().$implicit;l("routerLink",_(1,ne,t.id))}}function ge(i,d){if(i&1&&(e(0,"button",69),m(1,"img",71),e(2,"span",41),o(3,"Contrase\xF1a"),r()()),i&2){let t=c().$implicit;l("routerLink",_(1,oe,t.id))}}function ve(i,d){if(i&1&&(e(0,"tr",54)(1,"td",55)(2,"div",4),x(3,me,2,0,"div",56)(4,ce,2,0,"div",57)(5,pe,2,0,"div",58),r()(),e(6,"td",59),o(7),r(),e(8,"td",59),o(9),r(),e(10,"td",60),o(11),r(),e(12,"td",60),o(13),r(),e(14,"td",61),x(15,fe,1,1,"app-pastilla-estado",62),r(),e(16,"td",61)(17,"div",63),x(18,xe,4,3,"button",64)(19,ge,4,3,"button",64),r()()()),i&2){let t=d.$implicit,a=c();l("ngClass",_(11,re,a.authService.usuario.userId===t.id)),s(3),l("ngIf",t.role=="USER_ROLE"),s(),l("ngIf",t.role=="ADMIN_ROLE"),s(),l("ngIf",t.role=="ENCUESTADOR_ROLE"),s(2),b(t.apellido.toLowerCase()),s(2),b(t.nombre.toLowerCase()),s(2),b(t.dni),s(2),b(t.usuario),s(2),l("ngIf",t.usuario!=="lmoreno"||a.authService.usuario.usuario==="lmoreno"),s(3),l("ngIf",t.usuario!=="lmoreno"||a.authService.usuario.usuario==="lmoreno"),s(),l("ngIf",t.usuario!=="lmoreno"||a.authService.usuario.usuario==="lmoreno")}}function he(i,d){i&1&&(e(0,"div",88),o(1," E "),r())}function be(i,d){i&1&&(e(0,"div",89),o(1," A "),r())}function _e(i,d){i&1&&(e(0,"div",90),o(1," En "),r())}function we(i,d){if(i&1&&(e(0,"button",91),m(1,"img",92),e(2,"span",93),o(3,"Editar"),r()()),i&2){let t=c().$implicit;l("routerLink",_(1,ne,t.id))}}function ye(i,d){if(i&1&&(e(0,"button",94),m(1,"img",95),e(2,"span",93),o(3,"Contrase\xF1a"),r()()),i&2){let t=c().$implicit;l("routerLink",_(1,oe,t.id))}}function Se(i,d){if(i&1){let t=S();e(0,"div",47)(1,"div")(2,"div",72),x(3,he,2,0,"div",73)(4,be,2,0,"div",74)(5,_e,2,0,"div",75),e(6,"div",76)(7,"p",77),o(8),r(),e(9,"p",78),o(10),r(),e(11,"div",79),w(),e(12,"svg",80),m(13,"path",81),r(),E(),e(14,"span",82),o(15),r()()()(),e(16,"div",83)(17,"app-pastilla-estado",84),h("click",function(){let n=g(t).$implicit,u=c();return v(u.actualizarEstado(n))}),r(),e(18,"div",85),x(19,we,4,3,"button",86)(20,ye,4,3,"button",87),r()()()()}if(i&2){let t=d.$implicit,a=c();l("ngClass",_(13,re,a.authService.usuario.userId===t.id)),s(),F(t.activo?t.role=="USER_ROLE"?"border-l-4 border-orange-500 p-4":"border-l-4 border-blue-500 p-4":"border-l-4 border-red-500 p-4"),s(2),l("ngIf",t.role=="USER_ROLE"),s(),l("ngIf",t.role=="ADMIN_ROLE"),s(),l("ngIf",t.role=="ENCUESTADOR_ROLE"),s(3),P("",t.apellido.toLowerCase()," ",t.nombre.toLowerCase(),""),s(2),b(t.usuario),s(5),M("DNI ",t.dni,""),s(2),l("activo",t.activo),s(2),l("ngIf",t.usuario!=="lmoreno"||a.authService.usuario.usuario==="lmoreno"),s(),l("ngIf",t.usuario!=="lmoreno"||a.authService.usuario.usuario==="lmoreno")}}function Ce(i,d){i&1&&(e(0,"div",48)(1,"p",96),o(2,"No se encontraron usuarios"),r()())}function Ee(i,d){if(i&1){let t=S();e(0,"div",97)(1,"pagination-controls",98),h("pageChange",function(n){g(t);let u=c();return v(u.paginaActual=n)}),r()()}}var Je=(()=>{class i{constructor(t,a,n,u){this.usuariosService=t,this.alertService=a,this.dataService=n,this.authService=u,this.permiso_escritura=["USUARIOS_ALL"],this.total=0,this.paginaActual=1,this.cantidadItems=10,this.filtro={activo:"true",parametro:""},this.ordenar={direccion:1,columna:"apellido"}}ngOnInit(){console.log(this.authService.usuario),this.dataService.ubicacionActual="Dashboard - Usuarios",this.alertService.loading(),this.listarUsuarios()}listarUsuarios(){this.usuariosService.listarUsuarios(this.ordenar.direccion,this.ordenar.columna).subscribe({next:t=>{let{usuarios:a,total:n}=t;this.usuarios=a,this.total=n,this.alertService.close()},error:({error:t})=>this.alertService.errorApi(t.message)})}actualizarEstado(t){let{id:a,activo:n}=t;this.alertService.question({msg:"\xBFQuieres actualizar el estado?",buttonText:"Actualizar"}).then(({isConfirmed:u})=>{u&&(this.alertService.loading(),this.usuariosService.actualizarUsuario(a,{activo:!n}).subscribe(()=>{this.alertService.loading(),this.listarUsuarios()},({error:p})=>{this.alertService.close(),this.alertService.errorApi(p.message)}))})}exportarUsuarios(){this.alertService.question({msg:"Exportando usuarios",buttonText:"Aceptar"}).then(({isConfirmed:t})=>{t&&(this.alertService.loading(),this.usuariosService.exportarUsuarios({direccion:this.ordenar.direccion===1?"asc":"desc",columna:this.ordenar.columna,activo:this.filtro.activo,parametro:this.filtro.parametro}).subscribe({next:a=>{let n=new Blob([a.body],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});ee(n,`Usuarios - ${Q(new Date,"dd-MM-yyyy")}`),this.alertService.close()},error:({error:a})=>this.alertService.errorApi(a.message)}))})}filtrarActivos(t){this.paginaActual=1,this.filtro.activo=t}filtrarParametro(t){this.paginaActual=1,this.filtro.parametro=t}ordenarPorColumna(t){this.ordenar.columna=t,this.ordenar.direccion=this.ordenar.direccion==1?-1:1,this.alertService.loading(),this.listarUsuarios()}static{this.\u0275fac=function(a){return new(a||i)(y(J),y(H),y(q),y(G))}}static{this.\u0275cmp=L({type:i,selectors:[["app-usuarios"]],standalone:!0,features:[D],decls:86,vars:27,consts:[["txtActivo",""],["txtParametro",""],[1,"max-w-full","mx-auto"],[1,"md:flex","md:items-center","w-full","md:justify-between","bg-gradient-to-r","from-gray-800","to-gray-700","text-white","px-8","py-6","rounded-t","shadow-lg"],[1,"flex","items-center"],[1,"bg-white","p-2","rounded-lg","shadow-md"],["src","assets/svg/usuarios.svg",1,"w-12","h-12"],[1,"ml-6"],[1,"text-2xl","md:text-3xl","font-bold","leading-tight","bg-clip-text","text-transparent","bg-gradient-to-r","from-white","to-gray-300"],[1,"text-gray-300","mt-2","flex","items-center"],[1,"text-sm","font-medium"],[1,"ml-1","text-gray-300"],[1,"flex","items-center","mt-4","md:mt-0","space-x-4"],["title","Exportar unidades",1,"boton-tabla-exportar",3,"click"],["src","assets/svg/excel.svg",1,"w-6","h-6"],[1,"ml-2","text-gray-700","font-medium"],["title","Nuevo usuario","routerLink","/dashboard/usuarios/nuevo",1,"boton-tabla-nuevo"],[1,"font-medium"],[1,"py-6","px-6","text-sm"],[1,"md:flex","md:items-center","md:justify-between","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","w-full"],[1,"relative"],[1,"w-full","text-sm","rounded-lg","border","border-gray-300","bg-white","px-4","py-2.5","focus:border-blue-500","focus:ring-2","focus:ring-blue-200",3,"change"],["value","true"],["value","false"],["value",""],["placeholder","Buscar usuario...",1,"w-full","text-sm","rounded-lg","border","border-gray-300","pl-10","pr-4","py-2.5","focus:border-blue-500","focus:ring-2","focus:ring-blue-200",3,"keyup"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-3"],["viewBox","0 0 24 24","fill","none","stroke","currentColor",1,"h-5","w-5","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],[1,"w-full","text-sm","rounded-lg","border","border-gray-300","bg-white","px-4","py-2.5","focus:border-blue-500","focus:ring-2","focus:ring-blue-200"],["value","10"],["value","20"],["value","50"],["value","100"],[1,"mt-6","hidden","md:block","overflow-x-auto"],[1,"inline-block","min-w-full","border","border-gray-200","rounded-lg","shadow-sm","overflow-hidden"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"cursor-pointer","flex","items-center",3,"click"],[1,"ml-2"],["class","w-4 h-4","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",4,"ngIf"],[1,"px-6","py-3","text-center","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50 transition-colors duration-200",3,"ngClass",4,"ngFor","ngForOf"],[1,"md:hidden","space-y-4","p-4","max-h-[500px]","overflow-y-auto"],[1,"bg-white","rounded-lg","shadow-lg","border","border-gray-100","overflow-hidden","hover:shadow-xl","transition-shadow","duration-300",3,"ngClass"],[1,"text-center","py-6","bg-gray-50","rounded-lg","border","border-gray-200"],["class","mt-6 px-6 py-4 bg-white border border-gray-200 rounded-lg shadow-sm flex items-center justify-center",4,"ngIf"],["viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"w-4","h-4"],["points","6 9 12 15 18 9"],["points","18 15 12 9 6 15"],["x1","5","y1","12","x2","19","y2","12"],[1,"hover:bg-gray-50","transition-colors","duration-200",3,"ngClass"],[1,"px-6","py-4","whitespace-nowrap"],["class","bg-orange-400 flex items-center font-semibold text-white text-xl w-10 h-10 rounded-full justify-center",4,"ngIf"],["class","bg-blue-400 flex items-center font-semibold text-white text-xl w-10 h-10 rounded-full justify-center",4,"ngIf"],["class","bg-green-400 flex items-center font-semibold text-white text-xl w-10 h-10 rounded-full justify-center",4,"ngIf"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900","capitalize"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-center"],[3,"activo","click",4,"ngIf"],[1,"flex","items-center","justify-center","space-x-3"],["class","flex items-center px-4 py-2 text-sm font-medium text-blue-600 hover:text-white bg-blue-50 hover:bg-blue-600 rounded-lg transition-all duration-300 border border-blue-200 hover:border-blue-500 shadow-sm hover:shadow-md",3,"routerLink",4,"ngIf"],[1,"bg-orange-400","flex","items-center","font-semibold","text-white","text-xl","w-10","h-10","rounded-full","justify-center"],[1,"bg-blue-400","flex","items-center","font-semibold","text-white","text-xl","w-10","h-10","rounded-full","justify-center"],[1,"bg-green-400","flex","items-center","font-semibold","text-white","text-xl","w-10","h-10","rounded-full","justify-center"],[3,"click","activo"],[1,"flex","items-center","px-4","py-2","text-sm","font-medium","text-blue-600","hover:text-white","bg-blue-50","hover:bg-blue-600","rounded-lg","transition-all","duration-300","border","border-blue-200","hover:border-blue-500","shadow-sm","hover:shadow-md",3,"routerLink"],["src","assets/svg/editar.svg",1,"w-4","h-4","opacity-80"],["src","assets/svg/candado.svg",1,"w-4","h-4","opacity-80"],[1,"flex","items-start"],["class","bg-orange-500 flex-shrink-0 flex items-center font-semibold text-white text-2xl justify-center w-12 h-12 rounded-full shadow-md",4,"ngIf"],["class","bg-blue-500 flex-shrink-0 flex items-center font-semibold text-white text-2xl justify-center w-12 h-12 rounded-full shadow-md",4,"ngIf"],["class","bg-green-500 flex-shrink-0 flex items-center font-semibold text-white text-2xl justify-center w-12 h-12 rounded-full shadow-md",4,"ngIf"],[1,"ml-3","flex-1","min-w-0"],[1,"font-semibold","text-lg","text-gray-900","capitalize","truncate"],[1,"text-sm","text-gray-600","mt-1","truncate"],[1,"flex","items-center","text-sm","text-gray-500","mt-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-1","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"],[1,"truncate"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","gap-3","mt-4","pt-4","border-t","border-gray-200"],[1,"transform","hover:scale-105","transition-transform","duration-200",3,"click","activo"],[1,"flex","flex-wrap","gap-2"],["class","flex items-center px-3 py-1.5 bg-blue-50 border border-blue-200 text-blue-600 rounded-lg hover:bg-blue-600 hover:text-white transition-all duration-300 shadow-sm hover:shadow-md",3,"routerLink",4,"ngIf"],["class","flex items-center px-3 py-1.5 bg-blue-50 text-blue-600 border border-blue-200 rounded-lg hover:bg-blue-600 hover:text-white transition-all duration-300 shadow-sm hover:shadow-md",3,"routerLink",4,"ngIf"],[1,"bg-orange-500","flex-shrink-0","flex","items-center","font-semibold","text-white","text-2xl","justify-center","w-12","h-12","rounded-full","shadow-md"],[1,"bg-blue-500","flex-shrink-0","flex","items-center","font-semibold","text-white","text-2xl","justify-center","w-12","h-12","rounded-full","shadow-md"],[1,"bg-green-500","flex-shrink-0","flex","items-center","font-semibold","text-white","text-2xl","justify-center","w-12","h-12","rounded-full","shadow-md"],[1,"flex","items-center","px-3","py-1.5","bg-blue-50","border","border-blue-200","text-blue-600","rounded-lg","hover:bg-blue-600","hover:text-white","transition-all","duration-300","shadow-sm","hover:shadow-md",3,"routerLink"],["src","assets/svg/editar.svg",1,"w-4","h-4"],[1,"ml-1.5","font-medium"],[1,"flex","items-center","px-3","py-1.5","bg-blue-50","text-blue-600","border","border-blue-200","rounded-lg","hover:bg-blue-600","hover:text-white","transition-all","duration-300","shadow-sm","hover:shadow-md",3,"routerLink"],["src","assets/svg/candado.svg",1,"w-4","h-4"],[1,"text-gray-500","font-medium"],[1,"mt-6","px-6","py-4","bg-white","border","border-gray-200","rounded-lg","shadow-sm","flex","items-center","justify-center"],["nextLabel","Siguiente","previousLabel","Anterior",1,"text-sm",3,"pageChange"]],template:function(a,n){if(a&1){let u=S();e(0,"app-tarjeta-lista")(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),m(5,"img",6),r(),e(6,"div",7)(7,"h2",8),o(8," Listado de usuarios "),r(),e(9,"p",9)(10,"span",10),o(11,"Total de usuarios:"),r(),e(12,"span",11),o(13),r()()()(),e(14,"div",12)(15,"button",13),h("click",function(){return g(u),v(n.exportarUsuarios())}),m(16,"img",14),e(17,"span",15),o(18,"Exportar"),r()(),e(19,"button",16)(20,"span",17),o(21,"Nueva usuario "),r()()()(),e(22,"div",18)(23,"div",19)(24,"div",20)(25,"div",21)(26,"select",22,0),h("change",function(){g(u);let f=I(27);return v(n.filtrarActivos(f.value))}),e(28,"option",23),o(29,"Activos"),r(),e(30,"option",24),o(31,"Inactivos"),r(),e(32,"option",25),o(33,"Todos"),r()()(),e(34,"div",21)(35,"input",26,1),h("keyup",function(){g(u);let f=I(36);return v(n.filtrarParametro(f.value))}),r(),e(37,"span",27),w(),e(38,"svg",28),m(39,"path",29),r()()(),E(),e(40,"div",21)(41,"select",30)(42,"option",31),o(43,"10 elementos"),r(),e(44,"option",32),o(45,"20 elementos"),r(),e(46,"option",33),o(47,"50 elementos"),r(),e(48,"option",34),o(49,"100 elementos"),r()()()()(),e(50,"div",35)(51,"div",36)(52,"table",37)(53,"thead",38)(54,"tr")(55,"th",39)(56,"div",40),h("click",function(){return g(u),v(n.ordenarPorColumna("role"))}),e(57,"span"),o(58,"Tipo"),r(),e(59,"span",41),x(60,le,2,0,"svg",42)(61,de,2,0,"svg",42)(62,ue,2,0,"svg",42),r()()(),e(63,"th",39),o(64,"Apellido"),r(),e(65,"th",39),o(66,"Nombre"),r(),e(67,"th",39),o(68,"DNI"),r(),e(69,"th",39),o(70,"Usuario"),r(),e(71,"th",43),o(72,"Estado"),r(),e(73,"th",43),o(74,"Acciones "),r()()(),e(75,"tbody",44),x(76,ve,20,13,"tr",45),C(77,"filtroUsuarios"),C(78,"paginate"),r()()()(),e(79,"div",46),j(80,Se,21,15,"div",47,se,!1,Ce,3,0,"div",48),C(83,"filtroUsuarios"),C(84,"paginate"),r(),x(85,Ee,2,0,"div",49),r()()()}a&2&&(s(13),b(n.usuarios.length),s(47),l("ngIf",n.ordenar.columna=="role"&&n.ordenar.direccion==1),s(),l("ngIf",n.ordenar.columna=="role"&&n.ordenar.direccion==-1),s(),l("ngIf",n.ordenar.columna!="role"),s(14),l("ngForOf",U(78,11,T(77,7,n.usuarios,n.filtro.parametro,n.filtro.activo),k(21,ie,n.cantidadItems,n.paginaActual))),s(4),V(U(84,18,T(83,14,n.usuarios,n.filtro.parametro,n.filtro.activo),k(24,ie,n.cantidadItems,n.paginaActual))),s(5),l("ngIf",n.usuarios.length>n.cantidadItems))},dependencies:[N,B,O,R,K,z,$,W,te,Z,X,Y],encapsulation:2})}}return i})();export{Je as default};
