import{a as le}from"./chunk-63FRCMOQ.js";import{a as ae}from"./chunk-GN3ET3J5.js";import{a as re,b as se,c as oe}from"./chunk-FPMBAJ7G.js";import{a as ne}from"./chunk-K6KQI4JH.js";import"./chunk-SJRNDLBU.js";import"./chunk-2RS6V53X.js";import{d as X,g as Y,k as Z,l as $,m as ee,q as te}from"./chunk-CWJIG2GF.js";import{a as ie}from"./chunk-VUVQYZVZ.js";import"./chunk-5QPYTDH3.js";import{a as K}from"./chunk-QCJTTT55.js";import{g as H,h as U,k as J}from"./chunk-DJ4G2GYC.js";import{k as Q,m as R,n as O,p as q}from"./chunk-AMUWJEPN.js";import{A as j,Ab as N,Gb as G,H as B,Hb as D,Ib as z,Kb as s,Lb as S,Mb as b,Pb as I,Qb as k,Rb as T,Tb as W,Ua as r,Va as E,Vb as A,Xb as M,Yb as w,_b as y,ga as L,ib as h,kb as m,ob as x,pb as C,qa as p,qb as t,ra as v,rb as i,sa as f,sb as d,t as P,ta as F,vb as V,zb as _}from"./chunk-DRQLPHCS.js";var ue=["buscadorEncuestas"],ce=(a,l)=>l.id,de=(a,l,n)=>({itemsPerPage:a,currentPage:l,totalItems:n}),me=a=>["/dashboard/encuestas/detalles",a];function pe(a,l){if(a&1){let n=V();t(0,"div",42)(1,"button",43),_("click",function(){p(n);let e=N();return v(e.encuestasService.abrirAbm("crear"))}),t(2,"span",44),s(3,"Nueva encuesta"),i()()()}}function ve(a,l){a&1&&(f(),t(0,"svg",45),d(1,"path",46),i())}function ge(a,l){a&1&&(t(0,"div",47),d(1,"div",48),i())}function fe(a,l){a&1&&(f(),t(0,"svg",49),d(1,"path",50),i())}function _e(a,l){a&1&&(f(),t(0,"svg",49),d(1,"path",51),i())}function he(a,l){a&1&&(f(),t(0,"svg",49),d(1,"path",50),i())}function Ee(a,l){a&1&&(f(),t(0,"svg",49),d(1,"path",51),i())}function Se(a,l){a&1&&(f(),t(0,"svg",49),d(1,"path",50),i())}function be(a,l){a&1&&(f(),t(0,"svg",49),d(1,"path",51),i())}function we(a,l){a&1&&(f(),t(0,"svg",49),d(1,"path",50),i())}function ye(a,l){a&1&&(f(),t(0,"svg",49),d(1,"path",51),i())}function xe(a,l){if(a&1&&(t(0,"tr",36)(1,"td",52)(2,"div"),s(3),i()(),t(4,"td",52)(5,"div"),s(6),i()(),t(7,"td",53)(8,"div"),s(9),w(10,"date"),i()(),t(11,"td",53)(12,"div")(13,"span",54),s(14),i()()(),t(15,"td",55)(16,"button",56),d(17,"img",57),t(18,"span",58),s(19," Detalles "),i()()()()),a&2){let n=l.$implicit;r(3),S(n.id),r(3),S(n.titulo),r(3),S(y(10,6,n.createdAt,"dd/MM/yyyy")),r(4),m("ngClass",n.estado==="Activa"?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),r(),b(" ",n.estado," "),r(2),m("routerLink",A(9,me,n.id))}}function Ce(a,l){a&1&&(t(0,"tr")(1,"td",59),s(2," No se encontraron encuestas "),i()())}function Ve(a,l){if(a&1&&(t(0,"div",38)(1,"div",60)(2,"div",61)(3,"div")(4,"div",62),s(5),i(),t(6,"div",63),f(),t(7,"svg",64),d(8,"path",65),i(),s(9),w(10,"date"),i(),F(),t(11,"div",66),s(12),i()()(),t(13,"div",67)(14,"button",56),d(15,"img",57),t(16,"span",68),s(17,"Detalles"),i()()()()()),a&2){let n=l.$implicit;r(5),S(n.titulo),r(4),b(" ",y(10,4,n.createdAt,"dd/MM/yyyy")," "),r(3),b(" Estado: ",n.estado," "),r(2),m("routerLink",A(7,me,n.id))}}function Ie(a,l){a&1&&(t(0,"div",39),s(1," No se encontraron encuestas "),i())}var Re=(()=>{class a{constructor(n,c,e,o){this.router=n,this.authService=c,this.encuestasService=e,this.alertService=o,this.permiso_escritura=["ENCUESTAS_ALL"],this.paginaActual=1,this.cantidadItems=10,this.filtro={estado:"",parametro:""},this.ordenar={direccion:"desc",columna:"id"},this.cargandoEncuestas=!1}ngOnInit(){this.alertService.loading(),this.listarEncuestas()}ngAfterViewInit(){j(this.buscadorEncuestas.nativeElement,"keyup").pipe(P(n=>n.target.value),B(300)).subscribe(n=>{this.filtro.parametro=n,this.cambiarPagina(1)})}listarEncuestas(){this.cargandoEncuestas=!0;let n={direccion:this.ordenar.direccion,columna:this.ordenar.columna,pagina:this.paginaActual,itemsPorPagina:this.cantidadItems,estado:this.filtro.estado,parametro:this.filtro.parametro};this.encuestasService.listarEncuestas(n).subscribe({next:({encuestas:c,totalItems:e})=>{this.encuestasService.encuestas=c,this.encuestasService.total=e,this.cargandoEncuestas=!1,this.alertService.close()},error:({error:c})=>this.alertService.errorApi(c.message)})}nuevaEncuesta(n){this.encuestasService.encuestas=[n,...this.encuestasService.encuestas],this.ordenarEncuestas(),this.alertService.close(),this.router.navigate(["/dashboard/encuestas/detalles",n.id])}actualizarEncuesta(n){let c=this.encuestasService.encuestas.findIndex(e=>e.id===n.id);this.encuestasService.encuestas[c]=n,this.encuestasService.encuestas=[...this.encuestasService.encuestas],this.ordenarEncuestas(),this.alertService.close()}actualizarEstado(n){let{id:c,activo:e}=n;this.alertService.question({msg:n.activo?"Baja de elemento":"Alta de elemento",buttonText:n.activo?"Dar de baja":"Dar de alta"}).then(({isConfirmed:o})=>{o&&(this.alertService.loading(),this.encuestasService.actualizarEncuesta(c,{activo:!e}).subscribe({next:()=>{this.alertService.loading(),this.listarEncuestas()},error:({error:g})=>this.alertService.errorApi(g.message)}))})}filtrarParametro(n){this.paginaActual=1,this.filtro.parametro=n}ordenarPorColumna(n){this.ordenar.columna=n,this.ordenar.direccion=this.ordenar.direccion=="asc"?"desc":"asc",this.alertService.loading(),this.listarEncuestas()}ordenarEncuestas(){this.encuestasService.encuestas.sort((n,c)=>{let e=n.titulo.toLowerCase(),o=c.titulo.toLowerCase();return this.ordenar.direccion==="asc"?e<o?-1:e>o?1:0:e>o?-1:e<o?1:0})}cambiarPagina(n){this.paginaActual=n,this.listarEncuestas()}static{this.\u0275fac=function(c){return new(c||a)(E(H),E(K),E(ne),E(ie))}}static{this.\u0275cmp=L({type:a,selectors:[["app-encuestas"]],viewQuery:function(c,e){if(c&1&&G(ue,5),c&2){let o;D(o=z())&&(e.buscadorEncuestas=o.first)}},standalone:!0,features:[W],decls:88,vars:30,consts:[["buscadorEncuestas",""],[3,"insertEvent","updateEvent"],[1,"container","mx-auto"],[1,"md:flex","md:items-center","md:justify-between","bg-gradient-to-r","from-gray-800","to-gray-700","px-6","py-4","rounded-t"],[1,"flex","items-center"],[1,"bg-white","p-2","rounded-lg","shadow-md"],["src","assets/svg/encuestas.svg",1,"icono-tabla"],[1,"ml-4","text-white"],[1,"titulo-tabla"],[1,"subtitulo-tabla"],["class","flex items-center mt-4 md:mt-0 space-x-3",4,"ngIf"],[1,"bg-white","border-b","td-tabla"],[1,"md:flex","md:items-center","md:justify-between"],[1,"grid","grid-cols-1","sm:grid-cols-3","gap-4","w-full"],[1,"relative"],[1,"input-tabla",3,"change","ngModelChange","ngModel"],["value","Inactiva"],["value","Activa"],["value",""],["placeholder","Buscar encuesta...",1,"input-tabla-buscador"],["class","absolute left-3 top-3 h-4 w-4 text-gray-400","viewBox","0 0 24 24","fill","none","stroke","currentColor",4,"ngIf"],["class","absolute left-3 top-3",4,"ngIf"],["value","10"],["value","20"],["value","50"],["value","100"],[1,"hidden","md:block","overflow-x-auto"],[1,"inline-block","min-w-full"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"th-tabla"],[1,"group","cursor-pointer","flex","items-center",3,"click"],[1,"ml-2","text-gray-400","group-hover:text-gray-700"],["class","w-5 h-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"group","cursor-pointer","flex","items-center","justify-center",3,"click"],[1,"th-tabla","flex","items-center","justify-center"],[1,"bg-white","divide-y","divide-gray-200"],[1,"hover:bg-gray-50","transition-colors","duration-200"],[1,"md:hidden","space-y-4","p-4","max-h-[500px]","overflow-y-auto"],[1,"bg-white","rounded-lg","shadow-lg","border","border-gray-100","overflow-hidden","hover:shadow-xl","transition-shadow","duration-300"],[1,"text-center","py-4","text-gray-500","bg-gray-50","rounded-lg"],[1,"px-5","py-5","mt-4","text-sm","bg-white","border-t","flex","shadow","flex-col","xs:flex-row","items-center","xs:justify-between"],["nextLabel","Siguiente","previousLabel","Anterior",3,"pageChange"],[1,"flex","items-center","mt-4","md:mt-0","space-x-3"],["title","Nueva encuesta",1,"boton-tabla-nuevo",3,"click"],[1,"font-medium"],["viewBox","0 0 24 24","fill","none","stroke","currentColor",1,"absolute","left-3","top-3","h-4","w-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],[1,"absolute","left-3","top-3"],[1,"animate-spin","rounded-full","h-4","w-4","border-b-2","border-gray-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 15l7-7 7 7"],[1,"td-tabla"],[1,"td-tabla","text-center"],[1,"px-3","py-1","text-sm","font-medium","rounded-full",3,"ngClass"],[1,"td-tabla","flex","items-center","justify-center","whitespace-nowrap","text-center"],["title","Editar encuesta",1,"boton-tabla-editar",3,"routerLink"],["src","assets/svg/detalles.svg",1,"w-4","h-4","opacity-80"],[1,"ml-2"],["colspan","5",1,"td-tabla","text-center","text-sm","text-gray-500","bg-gray-50"],[1,"border-l-4","border-blue-500","p-5"],[1,"flex","items-center","justify-between"],[1,"font-semibold","text-lg","text-gray-900"],[1,"text-sm","text-gray-500","mt-1","flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"text-sm","text-gray-600","mt-1"],[1,"mt-4","flex","items-center","justify-end","space-x-3"],[1,"ml-2","font-medium"]],template:function(c,e){if(c&1){let o=V();t(0,"app-abm-encuestas",1),_("insertEvent",function(u){return p(o),v(e.nuevaEncuesta(u))})("updateEvent",function(u){return p(o),v(e.actualizarEncuesta(u))}),i(),t(1,"div",2)(2,"app-tarjeta-lista")(3,"div",2)(4,"div")(5,"div",3)(6,"div",4)(7,"div",5),d(8,"img",6),i(),t(9,"div",7)(10,"h2",8),s(11," Encuestas "),i(),t(12,"p",9),s(13),i()()(),h(14,pe,4,0,"div",10),i(),t(15,"div",11)(16,"div",12)(17,"div",13)(18,"div",14)(19,"select",15),_("change",function(){return p(o),v(e.cambiarPagina(1))}),T("ngModelChange",function(u){return p(o),k(e.filtro.estado,u)||(e.filtro.estado=u),v(u)}),t(20,"option",16),s(21,"Inactivas"),i(),t(22,"option",17),s(23,"Activas"),i(),t(24,"option",18),s(25,"Todas"),i()()(),t(26,"div",14),d(27,"input",19,0),h(29,ve,2,0,"svg",20)(30,ge,2,0,"div",21),i(),t(31,"select",15),_("change",function(){return p(o),v(e.cambiarPagina(1))}),T("ngModelChange",function(u){return p(o),k(e.cantidadItems,u)||(e.cantidadItems=u),v(u)}),t(32,"option",22),s(33,"10 elementos"),i(),t(34,"option",23),s(35,"20 elementos"),i(),t(36,"option",24),s(37,"50 elementos"),i(),t(38,"option",25),s(39,"100 elementos"),i()()()()(),t(40,"div",26)(41,"div",27)(42,"table",28)(43,"thead")(44,"tr")(45,"th",29)(46,"div",30),_("click",function(){return p(o),v(e.ordenarPorColumna("id"))}),t(47,"span"),s(48," Numero "),i(),t(49,"span",31),h(50,fe,2,0,"svg",32)(51,_e,2,0,"svg",32),i()()(),t(52,"th",29)(53,"div",30),_("click",function(){return p(o),v(e.ordenarPorColumna("titulo"))}),t(54,"span"),s(55,"T\xEDtulo"),i(),t(56,"span",31),h(57,he,2,0,"svg",32)(58,Ee,2,0,"svg",32),i()()(),t(59,"th",29)(60,"div",33),_("click",function(){return p(o),v(e.ordenarPorColumna("fechaCreacion"))}),t(61,"span"),s(62,"Fecha de creaci\xF3n"),i(),t(63,"span",31),h(64,Se,2,0,"svg",32)(65,be,2,0,"svg",32),i()()(),t(66,"th",29)(67,"div",33),_("click",function(){return p(o),v(e.ordenarPorColumna("estado"))}),t(68,"span"),s(69,"Estado"),i(),t(70,"span",31),h(71,we,2,0,"svg",32)(72,ye,2,0,"svg",32),i()()(),t(73,"th",34)(74,"span"),s(75,"Acciones"),i()()()(),t(76,"tbody",35),x(77,xe,20,11,"tr",36,ce,!1,Ce,3,0,"tr"),w(80,"paginate"),i()()()(),t(81,"div",37),x(82,Ve,18,9,"div",38,ce,!1,Ie,2,0,"div",39),w(85,"paginate"),i(),t(86,"div",40)(87,"pagination-controls",41),_("pageChange",function(u){return p(o),v(e.cambiarPagina(u))}),i()()()()()()}c&2&&(r(13),b(" Total de encuestas: ",e.encuestasService.total," "),r(),m("ngIf",e.authService.isAdmin),r(5),I("ngModel",e.filtro.estado),r(10),m("ngIf",!e.cargandoEncuestas),r(),m("ngIf",e.cargandoEncuestas),r(),I("ngModel",e.cantidadItems),r(19),m("ngIf",e.ordenar.columna=="id"&&e.ordenar.direccion=="asc"),r(),m("ngIf",e.ordenar.columna=="id"&&e.ordenar.direccion=="desc"),r(6),m("ngIf",e.ordenar.columna=="titulo"&&e.ordenar.direccion=="asc"),r(),m("ngIf",e.ordenar.columna=="titulo"&&e.ordenar.direccion=="desc"),r(6),m("ngIf",e.ordenar.columna=="fechaCreacion"&&e.ordenar.direccion=="asc"),r(),m("ngIf",e.ordenar.columna=="fechaCreacion"&&e.ordenar.direccion=="desc"),r(6),m("ngIf",e.ordenar.columna=="estado"&&e.ordenar.direccion=="asc"),r(),m("ngIf",e.ordenar.columna=="estado"&&e.ordenar.direccion=="desc"),r(5),C(y(80,16,e.encuestasService.encuestas,M(22,de,e.cantidadItems,e.paginaActual,e.encuestasService.total))),r(5),C(y(85,19,e.encuestasService.encuestas,M(26,de,e.cantidadItems,e.paginaActual,e.encuestasService.total))))},dependencies:[q,Q,R,O,te,$,ee,Z,X,Y,le,ae,oe,re,se,J,U],encapsulation:2})}}return a})();export{Re as default};
