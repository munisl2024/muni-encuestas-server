import{a as ae}from"./chunk-JG7STQLI.js";import{a as ee}from"./chunk-ZDESPTUY.js";import{a as te,b as ne,c as ie}from"./chunk-7QN23H67.js";import{a as Z}from"./chunk-J3BUK4MO.js";import"./chunk-F245QUT2.js";import"./chunk-TFEDABXG.js";import{c as H,f as U,j as J,k as K,l as W,p as X}from"./chunk-LNBIFSMN.js";import{a as Y}from"./chunk-7ASKJ65C.js";import"./chunk-JN7XREYN.js";import{a as q}from"./chunk-YESQC6II.js";import{g as R,h as O,k as $}from"./chunk-LIJZX7MQ.js";import{k as G,m as D,n as z,p as Q}from"./chunk-UHNCRVEK.js";import{$ as T,Bb as s,Cb as h,D as k,Db as _,Jb as F,Lb as y,Nb as C,Ob as E,Qb as S,Tb as N,Ua as r,Ub as B,Va as f,Wb as L,cb as d,ea as A,fa as M,ga as p,ha as P,hb as g,ib as b,jb as x,kb as t,lb as n,mb as m,pb as j,s as w,ub as v,vb as V,z as I}from"./chunk-GYUG5PKY.js";var le=["buscadorEncuestas"],re=(a,l)=>l.id;function ce(a,l){if(a&1){let i=j();t(0,"div",39)(1,"button",40),v("click",function(){A(i);let e=V();return M(e.encuestasService.abrirAbm("crear"))}),t(2,"span",41),s(3,"Nueva encuesta"),n()()()}}function de(a,l){a&1&&(p(),t(0,"svg",42),m(1,"path",43),n())}function me(a,l){a&1&&(t(0,"div",44),m(1,"div",45),n())}function ue(a,l){a&1&&(p(),t(0,"svg",46),m(1,"path",47),n())}function pe(a,l){a&1&&(p(),t(0,"svg",46),m(1,"path",48),n())}function ve(a,l){a&1&&(p(),t(0,"svg",46),m(1,"path",47),n())}function ge(a,l){a&1&&(p(),t(0,"svg",46),m(1,"path",48),n())}function fe(a,l){a&1&&(p(),t(0,"svg",46),m(1,"path",47),n())}function he(a,l){a&1&&(p(),t(0,"svg",46),m(1,"path",48),n())}function _e(a,l){a&1&&(p(),t(0,"svg",46),m(1,"path",47),n())}function Ee(a,l){a&1&&(p(),t(0,"svg",46),m(1,"path",48),n())}var oe=a=>["/dashboard/encuestas/detalles",a];function Se(a,l){if(a&1&&(t(0,"tr",49)(1,"td",50)(2,"div"),s(3),n()(),t(4,"td",50)(5,"div"),s(6),n()(),t(7,"td",51)(8,"div"),s(9),E(10,"date"),n()(),t(11,"td",51)(12,"div")(13,"span",52),s(14),n()()(),t(15,"td",53)(16,"button",54),m(17,"img",55),t(18,"span",56),s(19," Detalles "),n()()()()),a&2){let i=l.$implicit;r(3),h(i.id),r(3),h(i.titulo),r(3),h(S(10,6,i.createdAt,"dd/MM/yyyy")),r(4),d("ngClass",i.estado==="Activa"?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"),r(1),_(" ",i.estado," "),r(2),d("routerLink",y(9,oe,i.id))}}function be(a,l){a&1&&(t(0,"tr")(1,"td",57),s(2," No se encontraron encuestas "),n()())}function xe(a,l){if(a&1&&(t(0,"div",58)(1,"div",59)(2,"div",60)(3,"div")(4,"div",61),s(5),n(),t(6,"div",62),p(),t(7,"svg",63),m(8,"path",64),n(),s(9),E(10,"date"),n(),P(),t(11,"div",65),s(12),n()()(),t(13,"div",66)(14,"button",54),m(15,"img",55),t(16,"span",67),s(17,"Detalles"),n()()()()()),a&2){let i=l.$implicit;r(5),h(i.titulo),r(4),_(" ",S(10,4,i.createdAt,"dd/MM/yyyy")," "),r(3),_(" Estado: ",i.estado," "),r(2),d("routerLink",y(7,oe,i.id))}}function ye(a,l){a&1&&(t(0,"div",68),s(1," No se encontraron encuestas "),n())}var se=(a,l,i)=>({itemsPerPage:a,currentPage:l,totalItems:i}),De=(()=>{class a{constructor(i,c,e,o){this.router=i,this.authService=c,this.encuestasService=e,this.alertService=o,this.permiso_escritura=["ENCUESTAS_ALL"],this.paginaActual=1,this.cantidadItems=10,this.filtro={estado:"",parametro:""},this.ordenar={direccion:"desc",columna:"id"},this.cargandoEncuestas=!1}ngOnInit(){this.alertService.loading(),this.listarEncuestas()}ngAfterViewInit(){I(this.buscadorEncuestas.nativeElement,"keyup").pipe(w(i=>i.target.value),k(300)).subscribe(i=>{this.filtro.parametro=i,this.cambiarPagina(1)})}listarEncuestas(){this.cargandoEncuestas=!0;let i={direccion:this.ordenar.direccion,columna:this.ordenar.columna,pagina:this.paginaActual,itemsPorPagina:this.cantidadItems,estado:this.filtro.estado,parametro:this.filtro.parametro};this.encuestasService.listarEncuestas(i).subscribe({next:({encuestas:c,totalItems:e})=>{this.encuestasService.encuestas=c,this.encuestasService.total=e,this.cargandoEncuestas=!1,this.alertService.close()},error:({error:c})=>this.alertService.errorApi(c.message)})}nuevaEncuesta(i){this.encuestasService.encuestas=[i,...this.encuestasService.encuestas],this.ordenarEncuestas(),this.alertService.close(),this.router.navigate(["/dashboard/encuestas/detalles",i.id])}actualizarEncuesta(i){let c=this.encuestasService.encuestas.findIndex(e=>e.id===i.id);this.encuestasService.encuestas[c]=i,this.encuestasService.encuestas=[...this.encuestasService.encuestas],this.ordenarEncuestas(),this.alertService.close()}actualizarEstado(i){let{id:c,activo:e}=i;this.alertService.question({msg:i.activo?"Baja de elemento":"Alta de elemento",buttonText:i.activo?"Dar de baja":"Dar de alta"}).then(({isConfirmed:o})=>{o&&(this.alertService.loading(),this.encuestasService.actualizarEncuesta(c,{activo:!e}).subscribe({next:()=>{this.alertService.loading(),this.listarEncuestas()},error:({error:u})=>this.alertService.errorApi(u.message)}))})}filtrarParametro(i){this.paginaActual=1,this.filtro.parametro=i}ordenarPorColumna(i){this.ordenar.columna=i,this.ordenar.direccion=this.ordenar.direccion=="asc"?"desc":"asc",this.alertService.loading(),this.listarEncuestas()}ordenarEncuestas(){this.encuestasService.encuestas.sort((i,c)=>{let e=i.titulo.toLowerCase(),o=c.titulo.toLowerCase();return this.ordenar.direccion==="asc"?e<o?-1:e>o?1:0:e>o?-1:e<o?1:0})}cambiarPagina(i){this.paginaActual=i,this.listarEncuestas()}static{this.\u0275fac=function(c){return new(c||a)(f(R),f(q),f(Z),f(Y))}}static{this.\u0275cmp=T({type:a,selectors:[["app-encuestas"]],viewQuery:function(c,e){if(c&1&&B(le,5),c&2){let o;N(o=L())&&(e.buscadorEncuestas=o.first)}},standalone:!0,features:[F],decls:88,vars:30,consts:[[3,"insertEvent","updateEvent"],[1,"container","mx-auto"],[1,"md:flex","md:items-center","md:justify-between","bg-gradient-to-r","from-gray-800","to-gray-700","px-6","py-4","rounded-t"],[1,"flex","items-center"],[1,"bg-white","p-2","rounded-lg","shadow-md"],["src","assets/svg/encuestas.svg",1,"icono-tabla"],[1,"ml-4","text-white"],[1,"titulo-tabla"],[1,"subtitulo-tabla"],["class","flex items-center mt-4 md:mt-0 space-x-3",4,"ngIf"],[1,"bg-white","border-b","td-tabla"],[1,"md:flex","md:items-center","md:justify-between"],[1,"grid","grid-cols-1","sm:grid-cols-3","gap-4","w-full"],[1,"relative"],[1,"input-tabla",3,"ngModel","change","ngModelChange"],["value","Inactiva"],["value","Activa"],["value",""],["placeholder","Buscar encuesta...",1,"input-tabla-buscador"],["buscadorEncuestas",""],["class","absolute left-3 top-3 h-4 w-4 text-gray-400","viewBox","0 0 24 24","fill","none","stroke","currentColor",4,"ngIf"],["class","absolute left-3 top-3",4,"ngIf"],["value","10"],["value","20"],["value","50"],["value","100"],[1,"hidden","md:block","overflow-x-auto"],[1,"inline-block","min-w-full"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"th-tabla"],[1,"group","cursor-pointer","flex","items-center",3,"click"],[1,"ml-2","text-gray-400","group-hover:text-gray-700"],["class","w-5 h-5","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"group","cursor-pointer","flex","items-center","justify-center",3,"click"],[1,"th-tabla","flex","items-center","justify-center"],[1,"bg-white","divide-y","divide-gray-200"],[1,"md:hidden","space-y-4","p-4","max-h-[500px]","overflow-y-auto"],[1,"px-5","py-5","mt-4","text-sm","bg-white","border-t","flex","shadow","flex-col","xs:flex-row","items-center","xs:justify-between"],["nextLabel","Siguiente","previousLabel","Anterior",3,"pageChange"],[1,"flex","items-center","mt-4","md:mt-0","space-x-3"],["title","Nueva encuesta",1,"boton-tabla-nuevo",3,"click"],[1,"font-medium"],["viewBox","0 0 24 24","fill","none","stroke","currentColor",1,"absolute","left-3","top-3","h-4","w-4","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],[1,"absolute","left-3","top-3"],[1,"animate-spin","rounded-full","h-4","w-4","border-b-2","border-gray-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 15l7-7 7 7"],[1,"hover:bg-gray-50","transition-colors","duration-200"],[1,"td-tabla"],[1,"td-tabla","text-center"],[1,"px-3","py-1","text-sm","font-medium","rounded-full",3,"ngClass"],[1,"td-tabla","flex","items-center","justify-center","whitespace-nowrap","text-center"],["title","Editar encuesta",1,"boton-tabla-editar",3,"routerLink"],["src","assets/svg/detalles.svg",1,"w-4","h-4","opacity-80"],[1,"ml-2"],["colspan","5",1,"td-tabla","text-center","text-sm","text-gray-500","bg-gray-50"],[1,"bg-white","rounded-lg","shadow-lg","border","border-gray-100","overflow-hidden","hover:shadow-xl","transition-shadow","duration-300"],[1,"border-l-4","border-blue-500","p-5"],[1,"flex","items-center","justify-between"],[1,"font-semibold","text-lg","text-gray-900"],[1,"text-sm","text-gray-500","mt-1","flex","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"text-sm","text-gray-600","mt-1"],[1,"mt-4","flex","items-center","justify-end","space-x-3"],[1,"ml-2","font-medium"],[1,"text-center","py-4","text-gray-500","bg-gray-50","rounded-lg"],["class","hover:bg-gray-50 transition-colors duration-200"],["class","bg-white rounded-lg shadow-lg border border-gray-100 overflow-hidden hover:shadow-xl transition-shadow duration-300"]],template:function(c,e){c&1&&(t(0,"app-abm-encuestas",0),v("insertEvent",function(u){return e.nuevaEncuesta(u)})("updateEvent",function(u){return e.actualizarEncuesta(u)}),n(),t(1,"div",1)(2,"app-tarjeta-lista")(3,"div",1)(4,"div")(5,"div",2)(6,"div",3)(7,"div",4),m(8,"img",5),n(),t(9,"div",6)(10,"h2",7),s(11," Encuestas "),n(),t(12,"p",8),s(13),n()()(),g(14,ce,4,0,"div",9),n(),t(15,"div",10)(16,"div",11)(17,"div",12)(18,"div",13)(19,"select",14),v("change",function(){return e.cambiarPagina(1)})("ngModelChange",function(u){return e.filtro.estado=u}),t(20,"option",15),s(21,"Inactivas"),n(),t(22,"option",16),s(23,"Activas"),n(),t(24,"option",17),s(25,"Todas"),n()()(),t(26,"div",13),m(27,"input",18,19),g(29,de,2,0,"svg",20)(30,me,2,0,"div",21),n(),t(31,"select",14),v("change",function(){return e.cambiarPagina(1)})("ngModelChange",function(u){return e.cantidadItems=u}),t(32,"option",22),s(33,"10 elementos"),n(),t(34,"option",23),s(35,"20 elementos"),n(),t(36,"option",24),s(37,"50 elementos"),n(),t(38,"option",25),s(39,"100 elementos"),n()()()()(),t(40,"div",26)(41,"div",27)(42,"table",28)(43,"thead")(44,"tr")(45,"th",29)(46,"div",30),v("click",function(){return e.ordenarPorColumna("id")}),t(47,"span"),s(48," Numero "),n(),t(49,"span",31),g(50,ue,2,0,"svg",32)(51,pe,2,0,"svg",32),n()()(),t(52,"th",29)(53,"div",30),v("click",function(){return e.ordenarPorColumna("titulo")}),t(54,"span"),s(55,"T\xEDtulo"),n(),t(56,"span",31),g(57,ve,2,0,"svg",32)(58,ge,2,0,"svg",32),n()()(),t(59,"th",29)(60,"div",33),v("click",function(){return e.ordenarPorColumna("fechaCreacion")}),t(61,"span"),s(62,"Fecha de creaci\xF3n"),n(),t(63,"span",31),g(64,fe,2,0,"svg",32)(65,he,2,0,"svg",32),n()()(),t(66,"th",29)(67,"div",33),v("click",function(){return e.ordenarPorColumna("estado")}),t(68,"span"),s(69,"Estado"),n(),t(70,"span",31),g(71,_e,2,0,"svg",32)(72,Ee,2,0,"svg",32),n()()(),t(73,"th",34)(74,"span"),s(75,"Acciones"),n()()()(),t(76,"tbody",35),b(77,Se,20,11,"tr",69,re,!1,be,3,0),E(80,"paginate"),n()()()(),t(81,"div",36),b(82,xe,18,9,"div",70,re,!1,ye,2,0),E(85,"paginate"),n(),t(86,"div",37)(87,"pagination-controls",38),v("pageChange",function(u){return e.cambiarPagina(u)}),n()()()()()()),c&2&&(r(13),_(" Total de encuestas: ",e.encuestasService.total," "),r(1),d("ngIf",e.authService.isAdmin),r(5),d("ngModel",e.filtro.estado),r(10),d("ngIf",!e.cargandoEncuestas),r(1),d("ngIf",e.cargandoEncuestas),r(1),d("ngModel",e.cantidadItems),r(19),d("ngIf",e.ordenar.columna=="id"&&e.ordenar.direccion=="asc"),r(1),d("ngIf",e.ordenar.columna=="id"&&e.ordenar.direccion=="desc"),r(6),d("ngIf",e.ordenar.columna=="titulo"&&e.ordenar.direccion=="asc"),r(1),d("ngIf",e.ordenar.columna=="titulo"&&e.ordenar.direccion=="desc"),r(6),d("ngIf",e.ordenar.columna=="fechaCreacion"&&e.ordenar.direccion=="asc"),r(1),d("ngIf",e.ordenar.columna=="fechaCreacion"&&e.ordenar.direccion=="desc"),r(6),d("ngIf",e.ordenar.columna=="estado"&&e.ordenar.direccion=="asc"),r(1),d("ngIf",e.ordenar.columna=="estado"&&e.ordenar.direccion=="desc"),r(5),x(S(80,16,e.encuestasService.encuestas,C(22,se,e.cantidadItems,e.paginaActual,e.encuestasService.total))),r(5),x(S(85,19,e.encuestasService.encuestas,C(26,se,e.cantidadItems,e.paginaActual,e.encuestasService.total))))},dependencies:[Q,G,D,z,X,K,W,J,H,U,ae,ee,ie,te,ne,$,O],encapsulation:2})}}return a})();export{De as default};
