import{a as U}from"./chunk-D43TIK6X.js";import{a as L}from"./chunk-DTMQF6TE.js";import{a as q}from"./chunk-OJWUDPLJ.js";import{b as T,d as j,g as k,q as D}from"./chunk-FMNQVWW6.js";import{a as W}from"./chunk-VUVQYZVZ.js";import{a as I}from"./chunk-JTVQZKZI.js";import{m as x,n as F,p as z}from"./chunk-PL2ZQQHO.js";import{Ab as _,Kb as s,Mb as y,Nb as C,Pb as v,Qb as E,Rb as h,Tb as M,Ua as u,Va as l,Yb as A,_b as w,a as S,b as f,ga as b,ib as g,kb as p,qb as i,rb as r,za as d,zb as m}from"./chunk-DRQLPHCS.js";function B(o,N){if(o&1&&(i(0,"div",9)(1,"div",10)(2,"div",11)(3,"h3",12),s(4,"Fecha de alta"),r()(),i(5,"p",13),s(6),A(7,"date"),r()(),i(8,"div",10)(9,"div",11)(10,"h3",12),s(11,"Usuario creador"),r()(),i(12,"p",14),s(13),r()()()),o&2){let a=_();u(6),y(" ",w(7,3,a.encuestasService.abmEncuesta.encuestaSeleccionada.createdAt,"dd/MM/yyyy")," "),u(7),C(" ",a.encuestasService.abmEncuesta.encuestaSeleccionada.creatorUser.apellido.toLowerCase()," ",a.encuestasService.abmEncuesta.encuestaSeleccionada.creatorUser.nombre.toLowerCase()," ")}}var ee=(()=>{class o{constructor(a,n,e,t){this.authService=a,this.alertService=n,this.encuestasService=e,this.toastr=t,this.insertEvent=new d,this.updateEvent=new d}ngOnInit(){}nuevaEncuesta(){let a=this.verificacionFormulario();if(a.trim()!==""){this.alertService.info(a);return}this.alertService.question({msg:"Creando nueva encuesta",buttonText:"Aceptar"}).then(({isConfirmed:n})=>{if(n){this.alertService.loading();let e=f(S({},this.encuestasService.abmEncuesta.form),{creatorUserId:this.authService.usuario.userId});this.encuestasService.nuevaEncuesta(e).subscribe({next:({encuesta:t})=>{this.insertEvent.emit(t),this.reinicioFormulario(),this.encuestasService.abmEncuesta.show=!1,this.toastr.success("Creada correctamente","Encuesta"),this.alertService.close()},error:({error:t})=>this.alertService.errorApi(t.message)})}})}actualizarEncuesta(){let a=this.verificacionFormulario();if(a.trim()!==""){this.alertService.info(a);return}this.alertService.question({msg:"Actualizando encuesta",buttonText:"Aceptar"}).then(({isConfirmed:n})=>{if(n){this.alertService.loading();let e=this.encuestasService.abmEncuesta.form;this.encuestasService.actualizarEncuesta(this.encuestasService.abmEncuesta.encuestaSeleccionada.id,e).subscribe({next:({encuesta:t})=>{this.updateEvent.emit(t),this.reinicioFormulario(),this.encuestasService.abmEncuesta.show=!1,this.toastr.success("Actualizada correctamente","Encuesta"),this.alertService.close()},error:({error:t})=>this.alertService.errorApi(t.message)})}})}verificacionFormulario(){let{titulo:a}=this.encuestasService.abmEncuesta.form;return a.trim()===""?"El titulo es requerido":""}submit(){this.encuestasService.abmEncuesta.estado=="crear"?this.nuevaEncuesta():this.actualizarEncuesta()}reinicioFormulario(){this.encuestasService.abmEncuesta.form={titulo:"",descripcion:""}}static{this.\u0275fac=function(n){return new(n||o)(l(I),l(W),l(U),l(L))}}static{this.\u0275cmp=b({type:o,selectors:[["app-abm-encuestas"]],outputs:{insertEvent:"insertEvent",updateEvent:"updateEvent"},standalone:!0,features:[M],decls:16,vars:10,consts:[[3,"closeModal","crear","actualizar","showModal","titulo","urlIcono","estadoFormulario","textoCrear","textoActualizar","showFooter"],[1,"bg-white","rounded-lg","shadow-xl"],[1,"p-6","max-h-96","overflow-y-auto"],[1,"space-y-4"],[1,"label-generico","mb-1"],[1,"text-red-500"],["type","text","placeholder","Ej. Encuesta de Satisfacci\xF3n",1,"input-generico","mt-1",3,"keyup.enter","ngModelChange","ngModel"],["type","text","placeholder","Ej. Esta encuesta busca evaluar...",1,"input-generico","mt-1",3,"keyup.enter","ngModelChange","ngModel"],["class","grid md:grid-cols-2 gap-4 mt-4",4,"ngIf"],[1,"grid","md:grid-cols-2","gap-4","mt-4"],[1,"bg-gray-50","p-4","rounded-lg","border","border-gray-300"],[1,"flex","items-center"],[1,"text-sm","font-semibold","text-gray-700"],[1,"text-sm","text-gray-600","mt-1"],[1,"text-sm","text-gray-600","mt-1","capitalize"]],template:function(n,e){n&1&&(i(0,"app-modal",0),m("closeModal",function(){return e.encuestasService.abmEncuesta.show=!1})("crear",function(){return e.nuevaEncuesta()})("actualizar",function(){return e.actualizarEncuesta()}),i(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"label",4),s(6," T\xEDtulo "),i(7,"span",5),s(8,"*"),r()(),i(9,"input",6),m("keyup.enter",function(){return e.submit()}),h("ngModelChange",function(c){return E(e.encuestasService.abmEncuesta.form.titulo,c)||(e.encuestasService.abmEncuesta.form.titulo=c),c}),r()(),i(10,"div")(11,"div")(12,"label",4),s(13," Descripci\xF3n "),r(),i(14,"input",7),m("keyup.enter",function(){return e.submit()}),h("ngModelChange",function(c){return E(e.encuestasService.abmEncuesta.form.descripcion,c)||(e.encuestasService.abmEncuesta.form.descripcion=c),c}),r()()(),g(15,B,14,6,"div",8),r()()()()),n&2&&(p("showModal",e.encuestasService.abmEncuesta.show)("titulo",e.encuestasService.abmEncuesta.estado=="crear"?"Creando encuesta":"Editando encuesta")("urlIcono","assets/svg/encuestas.svg")("estadoFormulario",e.encuestasService.abmEncuesta.estado)("textoCrear","Crear encuesta")("textoActualizar","Actualizar encuesta")("showFooter",!0),u(9),v("ngModel",e.encuestasService.abmEncuesta.form.titulo),u(5),v("ngModel",e.encuestasService.abmEncuesta.form.descripcion),u(),p("ngIf",e.encuestasService.abmEncuesta.encuestaSeleccionada&&e.encuestasService.abmEncuesta.estado==="editar"))},dependencies:[z,x,F,D,T,j,k,q],encapsulation:2})}}return o})();export{ee as a};
